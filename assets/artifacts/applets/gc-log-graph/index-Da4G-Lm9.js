import"../../../../shared/modulepreload-polyfill-B5Qt9EMX.js";import{S as Te,r as qe,i as Qe,d as Ke,a as me,T as qt,b as Qt}from"../../../../shared/transform-DpuiKT_l.js";import{b as Je,t as we,c as tn,a as en,w as nn,d as it,e as on,x as rn,y as sn,f as an,l as ut,g as Wt}from"../../../../shared/line-BFtWJ67O.js";function cn(t,e){let n,o;if(e===void 0)for(const r of t)r!=null&&(n===void 0?r>=r&&(n=o=r):(n>r&&(n=r),o<r&&(o=r)));else{let r=-1;for(let s of t)(s=e(s,++r,t))!=null&&(n===void 0?s>=s&&(n=o=s):(n>s&&(n=s),o<s&&(o=s)))}return[n,o]}function At(t,e){let n;if(e===void 0)for(const o of t)o!=null&&(n<o||n===void 0&&o>=o)&&(n=o);else{let o=-1;for(let r of t)(r=e(r,++o,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function ln(t){return t}var Kt=1,Yt=2,ie=3,Ut=4,Ce=1e-6;function un(t){return"translate("+t+",0)"}function mn(t){return"translate(0,"+t+")"}function fn(t){return e=>+t(e)}function hn(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function gn(){return!this.__axis}function fe(t,e){var n=[],o=null,r=null,s=6,i=6,f=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,m=t===Kt||t===Ut?-1:1,a=t===Ut||t===Yt?"x":"y",g=t===Kt||t===ie?un:mn;function h(v){var p=o??(e.ticks?e.ticks.apply(e,n):e.domain()),y=r??(e.tickFormat?e.tickFormat.apply(e,n):ln),L=Math.max(s,0)+f,u=e.range(),w=+u[0]+l,S=+u[u.length-1]+l,M=(e.bandwidth?hn:fn)(e.copy(),l),B=v.selection?v.selection():v,_=B.selectAll(".domain").data([null]),$=B.selectAll(".tick").data(p,e).order(),F=$.exit(),H=$.enter().append("g").attr("class","tick"),W=$.select("line"),et=$.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),$=$.merge(H),W=W.merge(H.append("line").attr("stroke","currentColor").attr(a+"2",m*s)),et=et.merge(H.append("text").attr("fill","currentColor").attr(a,m*L).attr("dy",t===Kt?"0em":t===ie?"0.71em":"0.32em")),v!==B&&(_=_.transition(v),$=$.transition(v),W=W.transition(v),et=et.transition(v),F=F.transition(v).attr("opacity",Ce).attr("transform",function(q){return isFinite(q=M(q))?g(q+l):this.getAttribute("transform")}),H.attr("opacity",Ce).attr("transform",function(q){var J=this.parentNode.__axis;return g((J&&isFinite(J=J(q))?J:M(q))+l)})),F.remove(),_.attr("d",t===Ut||t===Yt?i?"M"+m*i+","+w+"H"+l+"V"+S+"H"+m*i:"M"+l+","+w+"V"+S:i?"M"+w+","+m*i+"V"+l+"H"+S+"V"+m*i:"M"+w+","+l+"H"+S),$.attr("opacity",1).attr("transform",function(q){return g(M(q)+l)}),W.attr(a+"2",m*s),et.attr(a,m*L).text(y),B.filter(gn).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Yt?"start":t===Ut?"end":"middle"),B.each(function(){this.__axis=M})}return h.scale=function(v){return arguments.length?(e=v,h):e},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(v){return arguments.length?(n=v==null?[]:Array.from(v),h):n.slice()},h.tickValues=function(v){return arguments.length?(o=v==null?null:Array.from(v),h):o&&o.slice()},h.tickFormat=function(v){return arguments.length?(r=v,h):r},h.tickSize=function(v){return arguments.length?(s=i=+v,h):s},h.tickSizeInner=function(v){return arguments.length?(s=+v,h):s},h.tickSizeOuter=function(v){return arguments.length?(i=+v,h):i},h.tickPadding=function(v){return arguments.length?(f=+v,h):f},h.offset=function(v){return arguments.length?(l=+v,h):l},h}function pn(t){return fe(Yt,t)}function Me(t){return fe(ie,t)}function _e(t){return fe(Ut,t)}function P(t){return typeof t=="string"?new Te([[document.querySelector(t)]],[document.documentElement]):new Te([[t]],qe)}function dn(t){let e;for(;e=t.sourceEvent;)t=e;return t}function vt(t,e){if(t=dn(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const ce={capture:!0,passive:!1};function le(t){t.preventDefault(),t.stopImmediatePropagation()}function yn(t){var e=t.document.documentElement,n=P(t).on("dragstart.drag",le,ce);"onselectstart"in e?n.on("selectstart.drag",le,ce):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function vn(t,e){var n=t.document.documentElement,o=P(t).on("dragstart.drag",null);e&&(o.on("click.drag",le,ce),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var xn=1e-12;function Se(t){return((t=Math.exp(t))+1/t)/2}function Tn(t){return((t=Math.exp(t))-1/t)/2}function wn(t){return((t=Math.exp(2*t))-1)/(t+1)}const Cn=(function t(e,n,o){function r(s,i){var f=s[0],l=s[1],m=s[2],a=i[0],g=i[1],h=i[2],v=a-f,p=g-l,y=v*v+p*p,L,u;if(y<xn)u=Math.log(h/m)/e,L=function($){return[f+$*v,l+$*p,m*Math.exp(e*$*u)]};else{var w=Math.sqrt(y),S=(h*h-m*m+o*y)/(2*m*n*w),M=(h*h-m*m-o*y)/(2*h*n*w),B=Math.log(Math.sqrt(S*S+1)-S),_=Math.log(Math.sqrt(M*M+1)-M);u=(_-B)/e,L=function($){var F=$*u,H=Se(B),W=m/(n*w)*(H*wn(e*F+B)-Tn(B));return[f+W*v,l+W*p,m*H/Se(e*F+B)]}}return L.duration=u*1e3*e/Math.SQRT2,L}return r.rho=function(s){var i=Math.max(.001,+s),f=i*i,l=f*f;return t(i,f,l)},r})(Math.SQRT2,2,4);function Mn(t,e){t=t.slice();var n=0,o=t.length-1,r=t[n],s=t[o],i;return s<r&&(i=n,n=o,o=i,i=r,r=s,s=i),t[n]=e.floor(r),t[o]=e.ceil(s),t}const Jt=new Date,te=new Date;function X(t,e,n,o){function r(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return r.floor=s=>(t(s=new Date(+s)),s),r.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),r.round=s=>{const i=r(s),f=r.ceil(s);return s-i<f-s?i:f},r.offset=(s,i)=>(e(s=new Date(+s),i==null?1:Math.floor(i)),s),r.range=(s,i,f)=>{const l=[];if(s=r.ceil(s),f=f==null?1:Math.floor(f),!(s<i)||!(f>0))return l;let m;do l.push(m=new Date(+s)),e(s,f),t(s);while(m<s&&s<i);return l},r.filter=s=>X(i=>{if(i>=i)for(;t(i),!s(i);)i.setTime(i-1)},(i,f)=>{if(i>=i)if(f<0)for(;++f<=0;)for(;e(i,-1),!s(i););else for(;--f>=0;)for(;e(i,1),!s(i););}),n&&(r.count=(s,i)=>(Jt.setTime(+s),te.setTime(+i),t(Jt),t(te),Math.floor(n(Jt,te))),r.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?r.filter(o?i=>o(i)%s===0:i=>r.count(0,i)%s===0):r)),r}const Ot=X(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Ot.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?X(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Ot);Ot.range;const mt=1e3,ct=mt*60,ft=ct*60,ht=ft*24,he=ht*7,ke=ht*30,ee=ht*365,St=X(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*mt)},(t,e)=>(e-t)/mt,t=>t.getUTCSeconds());St.range;const ge=X(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*mt)},(t,e)=>{t.setTime(+t+e*ct)},(t,e)=>(e-t)/ct,t=>t.getMinutes());ge.range;const _n=X(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ct)},(t,e)=>(e-t)/ct,t=>t.getUTCMinutes());_n.range;const pe=X(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*mt-t.getMinutes()*ct)},(t,e)=>{t.setTime(+t+e*ft)},(t,e)=>(e-t)/ft,t=>t.getHours());pe.range;const Sn=X(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*ft)},(t,e)=>(e-t)/ft,t=>t.getUTCHours());Sn.range;const Ht=X(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ct)/ht,t=>t.getDate()-1);Ht.range;const de=X(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ht,t=>t.getUTCDate()-1);de.range;const kn=X(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ht,t=>Math.floor(t/ht));kn.range;function wt(t){return X(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*ct)/he)}const Xt=wt(0),Zt=wt(1),bn=wt(2),Rn=wt(3),kt=wt(4),Ln=wt(5),Dn=wt(6);Xt.range;Zt.range;bn.range;Rn.range;kt.range;Ln.range;Dn.range;function Ct(t){return X(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/he)}const Pe=Ct(0),Vt=Ct(1),Gn=Ct(2),$n=Ct(3),bt=Ct(4),zn=Ct(5),Un=Ct(6);Pe.range;Vt.range;Gn.range;$n.range;bt.range;zn.range;Un.range;const ye=X(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());ye.range;const En=X(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());En.range;const gt=X(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());gt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:X(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});gt.range;const Tt=X(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Tt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:X(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});Tt.range;function Bn(t,e,n,o,r,s){const i=[[St,1,mt],[St,5,5*mt],[St,15,15*mt],[St,30,30*mt],[s,1,ct],[s,5,5*ct],[s,15,15*ct],[s,30,30*ct],[r,1,ft],[r,3,3*ft],[r,6,6*ft],[r,12,12*ft],[o,1,ht],[o,2,2*ht],[n,1,he],[e,1,ke],[e,3,3*ke],[t,1,ee]];function f(m,a,g){const h=a<m;h&&([m,a]=[a,m]);const v=g&&typeof g.range=="function"?g:l(m,a,g),p=v?v.range(m,+a+1):[];return h?p.reverse():p}function l(m,a,g){const h=Math.abs(a-m)/g,v=Je(([,,L])=>L).right(i,h);if(v===i.length)return t.every(we(m/ee,a/ee,g));if(v===0)return Ot.every(Math.max(we(m,a,g),1));const[p,y]=i[h/i[v-1][2]<i[v][2]/h?v-1:v];return p.every(y)}return[f,l]}const[An,Fn]=Bn(gt,ye,Xt,Ht,pe,ge);function ne(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function oe(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Lt(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function In(t){var e=t.dateTime,n=t.date,o=t.time,r=t.periods,s=t.days,i=t.shortDays,f=t.months,l=t.shortMonths,m=Dt(r),a=Gt(r),g=Dt(s),h=Gt(s),v=Dt(i),p=Gt(i),y=Dt(f),L=Gt(f),u=Dt(l),w=Gt(l),S={a:G,A:z,b:U,B:E,c:null,d:$e,e:$e,f:co,g:xo,G:wo,H:so,I:ao,j:io,L:Ye,m:lo,M:uo,p:d,q:b,Q:Ee,s:Be,S:mo,u:fo,U:ho,V:go,w:po,W:yo,x:null,X:null,y:vo,Y:To,Z:Co,"%":Ue},M={a:A,A:R,b:j,B:O,c:null,d:ze,e:ze,f:ko,g:Bo,G:Fo,H:Mo,I:_o,j:So,L:We,m:bo,M:Ro,p:nt,q:lt,Q:Ee,s:Be,S:Lo,u:Do,U:Go,V:$o,w:zo,W:Uo,x:null,X:null,y:Eo,Y:Ao,Z:Io,"%":Ue},B={a:W,A:et,b:q,B:J,c,d:De,e:De,f:eo,g:Le,G:Re,H:Ge,I:Ge,j:Qn,L:to,m:qn,M:Kn,p:H,q:Xn,Q:oo,s:ro,S:Jn,u:Wn,U:On,V:Zn,w:Nn,W:Vn,x:D,X:x,y:Le,Y:Re,Z:jn,"%":no};S.x=_(n,S),S.X=_(o,S),S.c=_(e,S),M.x=_(n,M),M.X=_(o,M),M.c=_(e,M);function _(k,I){return function(Y){var T=[],tt=-1,Z=0,ot=k.length,rt,yt,xe;for(Y instanceof Date||(Y=new Date(+Y));++tt<ot;)k.charCodeAt(tt)===37&&(T.push(k.slice(Z,tt)),(yt=be[rt=k.charAt(++tt)])!=null?rt=k.charAt(++tt):yt=rt==="e"?" ":"0",(xe=I[rt])&&(rt=xe(Y,yt)),T.push(rt),Z=tt+1);return T.push(k.slice(Z,tt)),T.join("")}}function $(k,I){return function(Y){var T=Lt(1900,void 0,1),tt=F(T,k,Y+="",0),Z,ot;if(tt!=Y.length)return null;if("Q"in T)return new Date(T.Q);if("s"in T)return new Date(T.s*1e3+("L"in T?T.L:0));if(I&&!("Z"in T)&&(T.Z=0),"p"in T&&(T.H=T.H%12+T.p*12),T.m===void 0&&(T.m="q"in T?T.q:0),"V"in T){if(T.V<1||T.V>53)return null;"w"in T||(T.w=1),"Z"in T?(Z=oe(Lt(T.y,0,1)),ot=Z.getUTCDay(),Z=ot>4||ot===0?Vt.ceil(Z):Vt(Z),Z=de.offset(Z,(T.V-1)*7),T.y=Z.getUTCFullYear(),T.m=Z.getUTCMonth(),T.d=Z.getUTCDate()+(T.w+6)%7):(Z=ne(Lt(T.y,0,1)),ot=Z.getDay(),Z=ot>4||ot===0?Zt.ceil(Z):Zt(Z),Z=Ht.offset(Z,(T.V-1)*7),T.y=Z.getFullYear(),T.m=Z.getMonth(),T.d=Z.getDate()+(T.w+6)%7)}else("W"in T||"U"in T)&&("w"in T||(T.w="u"in T?T.u%7:"W"in T?1:0),ot="Z"in T?oe(Lt(T.y,0,1)).getUTCDay():ne(Lt(T.y,0,1)).getDay(),T.m=0,T.d="W"in T?(T.w+6)%7+T.W*7-(ot+5)%7:T.w+T.U*7-(ot+6)%7);return"Z"in T?(T.H+=T.Z/100|0,T.M+=T.Z%100,oe(T)):ne(T)}}function F(k,I,Y,T){for(var tt=0,Z=I.length,ot=Y.length,rt,yt;tt<Z;){if(T>=ot)return-1;if(rt=I.charCodeAt(tt++),rt===37){if(rt=I.charAt(tt++),yt=B[rt in be?I.charAt(tt++):rt],!yt||(T=yt(k,Y,T))<0)return-1}else if(rt!=Y.charCodeAt(T++))return-1}return T}function H(k,I,Y){var T=m.exec(I.slice(Y));return T?(k.p=a.get(T[0].toLowerCase()),Y+T[0].length):-1}function W(k,I,Y){var T=v.exec(I.slice(Y));return T?(k.w=p.get(T[0].toLowerCase()),Y+T[0].length):-1}function et(k,I,Y){var T=g.exec(I.slice(Y));return T?(k.w=h.get(T[0].toLowerCase()),Y+T[0].length):-1}function q(k,I,Y){var T=u.exec(I.slice(Y));return T?(k.m=w.get(T[0].toLowerCase()),Y+T[0].length):-1}function J(k,I,Y){var T=y.exec(I.slice(Y));return T?(k.m=L.get(T[0].toLowerCase()),Y+T[0].length):-1}function c(k,I,Y){return F(k,e,I,Y)}function D(k,I,Y){return F(k,n,I,Y)}function x(k,I,Y){return F(k,o,I,Y)}function G(k){return i[k.getDay()]}function z(k){return s[k.getDay()]}function U(k){return l[k.getMonth()]}function E(k){return f[k.getMonth()]}function d(k){return r[+(k.getHours()>=12)]}function b(k){return 1+~~(k.getMonth()/3)}function A(k){return i[k.getUTCDay()]}function R(k){return s[k.getUTCDay()]}function j(k){return l[k.getUTCMonth()]}function O(k){return f[k.getUTCMonth()]}function nt(k){return r[+(k.getUTCHours()>=12)]}function lt(k){return 1+~~(k.getUTCMonth()/3)}return{format:function(k){var I=_(k+="",S);return I.toString=function(){return k},I},parse:function(k){var I=$(k+="",!1);return I.toString=function(){return k},I},utcFormat:function(k){var I=_(k+="",M);return I.toString=function(){return k},I},utcParse:function(k){var I=$(k+="",!0);return I.toString=function(){return k},I}}}var be={"-":"",_:" ",0:"0"},Q=/^\s*\d+/,Hn=/^%/,Pn=/[\\^$*+?|[\]().{}]/g;function N(t,e,n){var o=t<0?"-":"",r=(o?-t:t)+"",s=r.length;return o+(s<n?new Array(n-s+1).join(e)+r:r)}function Yn(t){return t.replace(Pn,"\\$&")}function Dt(t){return new RegExp("^(?:"+t.map(Yn).join("|")+")","i")}function Gt(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Nn(t,e,n){var o=Q.exec(e.slice(n,n+1));return o?(t.w=+o[0],n+o[0].length):-1}function Wn(t,e,n){var o=Q.exec(e.slice(n,n+1));return o?(t.u=+o[0],n+o[0].length):-1}function On(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.U=+o[0],n+o[0].length):-1}function Zn(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.V=+o[0],n+o[0].length):-1}function Vn(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.W=+o[0],n+o[0].length):-1}function Re(t,e,n){var o=Q.exec(e.slice(n,n+4));return o?(t.y=+o[0],n+o[0].length):-1}function Le(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.y=+o[0]+(+o[0]>68?1900:2e3),n+o[0].length):-1}function jn(t,e,n){var o=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return o?(t.Z=o[1]?0:-(o[2]+(o[3]||"00")),n+o[0].length):-1}function Xn(t,e,n){var o=Q.exec(e.slice(n,n+1));return o?(t.q=o[0]*3-3,n+o[0].length):-1}function qn(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.m=o[0]-1,n+o[0].length):-1}function De(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.d=+o[0],n+o[0].length):-1}function Qn(t,e,n){var o=Q.exec(e.slice(n,n+3));return o?(t.m=0,t.d=+o[0],n+o[0].length):-1}function Ge(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.H=+o[0],n+o[0].length):-1}function Kn(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.M=+o[0],n+o[0].length):-1}function Jn(t,e,n){var o=Q.exec(e.slice(n,n+2));return o?(t.S=+o[0],n+o[0].length):-1}function to(t,e,n){var o=Q.exec(e.slice(n,n+3));return o?(t.L=+o[0],n+o[0].length):-1}function eo(t,e,n){var o=Q.exec(e.slice(n,n+6));return o?(t.L=Math.floor(o[0]/1e3),n+o[0].length):-1}function no(t,e,n){var o=Hn.exec(e.slice(n,n+1));return o?n+o[0].length:-1}function oo(t,e,n){var o=Q.exec(e.slice(n));return o?(t.Q=+o[0],n+o[0].length):-1}function ro(t,e,n){var o=Q.exec(e.slice(n));return o?(t.s=+o[0],n+o[0].length):-1}function $e(t,e){return N(t.getDate(),e,2)}function so(t,e){return N(t.getHours(),e,2)}function ao(t,e){return N(t.getHours()%12||12,e,2)}function io(t,e){return N(1+Ht.count(gt(t),t),e,3)}function Ye(t,e){return N(t.getMilliseconds(),e,3)}function co(t,e){return Ye(t,e)+"000"}function lo(t,e){return N(t.getMonth()+1,e,2)}function uo(t,e){return N(t.getMinutes(),e,2)}function mo(t,e){return N(t.getSeconds(),e,2)}function fo(t){var e=t.getDay();return e===0?7:e}function ho(t,e){return N(Xt.count(gt(t)-1,t),e,2)}function Ne(t){var e=t.getDay();return e>=4||e===0?kt(t):kt.ceil(t)}function go(t,e){return t=Ne(t),N(kt.count(gt(t),t)+(gt(t).getDay()===4),e,2)}function po(t){return t.getDay()}function yo(t,e){return N(Zt.count(gt(t)-1,t),e,2)}function vo(t,e){return N(t.getFullYear()%100,e,2)}function xo(t,e){return t=Ne(t),N(t.getFullYear()%100,e,2)}function To(t,e){return N(t.getFullYear()%1e4,e,4)}function wo(t,e){var n=t.getDay();return t=n>=4||n===0?kt(t):kt.ceil(t),N(t.getFullYear()%1e4,e,4)}function Co(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+N(e/60|0,"0",2)+N(e%60,"0",2)}function ze(t,e){return N(t.getUTCDate(),e,2)}function Mo(t,e){return N(t.getUTCHours(),e,2)}function _o(t,e){return N(t.getUTCHours()%12||12,e,2)}function So(t,e){return N(1+de.count(Tt(t),t),e,3)}function We(t,e){return N(t.getUTCMilliseconds(),e,3)}function ko(t,e){return We(t,e)+"000"}function bo(t,e){return N(t.getUTCMonth()+1,e,2)}function Ro(t,e){return N(t.getUTCMinutes(),e,2)}function Lo(t,e){return N(t.getUTCSeconds(),e,2)}function Do(t){var e=t.getUTCDay();return e===0?7:e}function Go(t,e){return N(Pe.count(Tt(t)-1,t),e,2)}function Oe(t){var e=t.getUTCDay();return e>=4||e===0?bt(t):bt.ceil(t)}function $o(t,e){return t=Oe(t),N(bt.count(Tt(t),t)+(Tt(t).getUTCDay()===4),e,2)}function zo(t){return t.getUTCDay()}function Uo(t,e){return N(Vt.count(Tt(t)-1,t),e,2)}function Eo(t,e){return N(t.getUTCFullYear()%100,e,2)}function Bo(t,e){return t=Oe(t),N(t.getUTCFullYear()%100,e,2)}function Ao(t,e){return N(t.getUTCFullYear()%1e4,e,4)}function Fo(t,e){var n=t.getUTCDay();return t=n>=4||n===0?bt(t):bt.ceil(t),N(t.getUTCFullYear()%1e4,e,4)}function Io(){return"+0000"}function Ue(){return"%"}function Ee(t){return+t}function Be(t){return Math.floor(+t/1e3)}var Mt,ve,Ze;Ho({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ho(t){return Mt=In(t),ve=Mt.format,Mt.parse,Ze=Mt.utcFormat,Mt.utcParse,Mt}function Po(t){return new Date(t)}function Yo(t){return t instanceof Date?+t:+new Date(+t)}function Ve(t,e,n,o,r,s,i,f,l,m){var a=tn(),g=a.invert,h=a.domain,v=m(".%L"),p=m(":%S"),y=m("%I:%M"),L=m("%I %p"),u=m("%a %d"),w=m("%b %d"),S=m("%B"),M=m("%Y");function B(_){return(l(_)<_?v:f(_)<_?p:i(_)<_?y:s(_)<_?L:o(_)<_?r(_)<_?u:w:n(_)<_?S:M)(_)}return a.invert=function(_){return new Date(g(_))},a.domain=function(_){return arguments.length?h(Array.from(_,Yo)):h().map(Po)},a.ticks=function(_){var $=h();return t($[0],$[$.length-1],_??10)},a.tickFormat=function(_,$){return $==null?B:m($)},a.nice=function(_){var $=h();return(!_||typeof _.range!="function")&&(_=e($[0],$[$.length-1],_??10)),_?h(Mn($,_)):a},a.copy=function(){return en(a,Ve(t,e,n,o,r,s,i,f,l,m))},a}function No(){return Qe.apply(Ve(An,Fn,gt,ye,Xt,Ht,pe,ge,St,ve).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function pt(t,e,n){var o=null,r=it(!0),s=null,i=on,f=null,l=nn(m);t=typeof t=="function"?t:t===void 0?rn:it(+t),e=typeof e=="function"?e:e===void 0?it(0):it(+e),n=typeof n=="function"?n:n===void 0?sn:it(+n);function m(g){var h,v,p,y=(g=an(g)).length,L,u=!1,w,S=new Array(y),M=new Array(y);for(s==null&&(f=i(w=l())),h=0;h<=y;++h){if(!(h<y&&r(L=g[h],h,g))===u)if(u=!u)v=h,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),p=h-1;p>=v;--p)f.point(S[p],M[p]);f.lineEnd(),f.areaEnd()}u&&(S[h]=+t(L,h,g),M[h]=+e(L,h,g),f.point(o?+o(L,h,g):S[h],n?+n(L,h,g):M[h]))}if(w)return f=null,w+""||null}function a(){return ut().defined(r).curve(i).context(s)}return m.x=function(g){return arguments.length?(t=typeof g=="function"?g:it(+g),o=null,m):t},m.x0=function(g){return arguments.length?(t=typeof g=="function"?g:it(+g),m):t},m.x1=function(g){return arguments.length?(o=g==null?null:typeof g=="function"?g:it(+g),m):o},m.y=function(g){return arguments.length?(e=typeof g=="function"?g:it(+g),n=null,m):e},m.y0=function(g){return arguments.length?(e=typeof g=="function"?g:it(+g),m):e},m.y1=function(g){return arguments.length?(n=g==null?null:typeof g=="function"?g:it(+g),m):n},m.lineX0=m.lineY0=function(){return a().x(t).y(e)},m.lineY1=function(){return a().x(t).y(n)},m.lineX1=function(){return a().x(o).y(e)},m.defined=function(g){return arguments.length?(r=typeof g=="function"?g:it(!!g),m):r},m.curve=function(g){return arguments.length?(i=g,s!=null&&(f=i(s)),m):i},m.context=function(g){return arguments.length?(g==null?s=f=null:f=i(s=g),m):s},m}function Ae(t){return t<0?-1:1}function Fe(t,e,n){var o=t._x1-t._x0,r=e-t._x1,s=(t._y1-t._y0)/(o||r<0&&-0),i=(n-t._y1)/(r||o<0&&-0),f=(s*r+i*o)/(o+r);return(Ae(s)+Ae(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(f))||0}function Ie(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function re(t,e,n){var o=t._x0,r=t._y0,s=t._x1,i=t._y1,f=(s-o)/3;t._context.bezierCurveTo(o+f,r+f*e,s-f,i-f*n,s,i)}function jt(t){this._context=t}jt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:re(this,this._t0,Ie(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,re(this,Ie(this,n=Fe(this,t,e)),n);break;default:re(this,this._t0,n=Fe(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};Object.create(jt.prototype).point=function(t,e){jt.prototype.point.call(this,e,t)};function dt(t){return new jt(t)}const Pt=t=>()=>t;function Wo(t,{sourceEvent:e,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function se(t){t.stopImmediatePropagation()}function $t(t){t.preventDefault(),t.stopImmediatePropagation()}function Oo(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Zo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function He(){return this.__zoom||me}function Vo(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function jo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xo(t,e,n){var o=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i))}function qo(){var t=Oo,e=Zo,n=Xo,o=Vo,r=jo,s=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],f=250,l=Cn,m=Ke("start","zoom","end"),a,g,h,v=500,p=150,y=0,L=10;function u(c){c.property("__zoom",He).on("wheel.zoom",F,{passive:!1}).on("mousedown.zoom",H).on("dblclick.zoom",W).filter(r).on("touchstart.zoom",et).on("touchmove.zoom",q).on("touchend.zoom touchcancel.zoom",J).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.transform=function(c,D,x,G){var z=c.selection?c.selection():c;z.property("__zoom",He),c!==z?B(c,D,x,G):z.interrupt().each(function(){_(this,arguments).event(G).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},u.scaleBy=function(c,D,x,G){u.scaleTo(c,function(){var z=this.__zoom.k,U=typeof D=="function"?D.apply(this,arguments):D;return z*U},x,G)},u.scaleTo=function(c,D,x,G){u.transform(c,function(){var z=e.apply(this,arguments),U=this.__zoom,E=x==null?M(z):typeof x=="function"?x.apply(this,arguments):x,d=U.invert(E),b=typeof D=="function"?D.apply(this,arguments):D;return n(S(w(U,b),E,d),z,i)},x,G)},u.translateBy=function(c,D,x,G){u.transform(c,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof x=="function"?x.apply(this,arguments):x),e.apply(this,arguments),i)},null,G)},u.translateTo=function(c,D,x,G,z){u.transform(c,function(){var U=e.apply(this,arguments),E=this.__zoom,d=G==null?M(U):typeof G=="function"?G.apply(this,arguments):G;return n(me.translate(d[0],d[1]).scale(E.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof x=="function"?-x.apply(this,arguments):-x),U,i)},G,z)};function w(c,D){return D=Math.max(s[0],Math.min(s[1],D)),D===c.k?c:new qt(D,c.x,c.y)}function S(c,D,x){var G=D[0]-x[0]*c.k,z=D[1]-x[1]*c.k;return G===c.x&&z===c.y?c:new qt(c.k,G,z)}function M(c){return[(+c[0][0]+ +c[1][0])/2,(+c[0][1]+ +c[1][1])/2]}function B(c,D,x,G){c.on("start.zoom",function(){_(this,arguments).event(G).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event(G).end()}).tween("zoom",function(){var z=this,U=arguments,E=_(z,U).event(G),d=e.apply(z,U),b=x==null?M(d):typeof x=="function"?x.apply(z,U):x,A=Math.max(d[1][0]-d[0][0],d[1][1]-d[0][1]),R=z.__zoom,j=typeof D=="function"?D.apply(z,U):D,O=l(R.invert(b).concat(A/R.k),j.invert(b).concat(A/j.k));return function(nt){if(nt===1)nt=j;else{var lt=O(nt),k=A/lt[2];nt=new qt(k,b[0]-lt[0]*k,b[1]-lt[1]*k)}E.zoom(null,nt)}})}function _(c,D,x){return!x&&c.__zooming||new $(c,D)}function $(c,D){this.that=c,this.args=D,this.active=0,this.sourceEvent=null,this.extent=e.apply(c,D),this.taps=0}$.prototype={event:function(c){return c&&(this.sourceEvent=c),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(c,D){return this.mouse&&c!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&c!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&c!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(c){var D=P(this.that).datum();m.call(c,this.that,new Wo(c,{sourceEvent:this.sourceEvent,target:u,transform:this.that.__zoom,dispatch:m}),D)}};function F(c,...D){if(!t.apply(this,arguments))return;var x=_(this,D).event(c),G=this.__zoom,z=Math.max(s[0],Math.min(s[1],G.k*Math.pow(2,o.apply(this,arguments)))),U=vt(c);if(x.wheel)(x.mouse[0][0]!==U[0]||x.mouse[0][1]!==U[1])&&(x.mouse[1]=G.invert(x.mouse[0]=U)),clearTimeout(x.wheel);else{if(G.k===z)return;x.mouse=[U,G.invert(U)],Qt(this),x.start()}$t(c),x.wheel=setTimeout(E,p),x.zoom("mouse",n(S(w(G,z),x.mouse[0],x.mouse[1]),x.extent,i));function E(){x.wheel=null,x.end()}}function H(c,...D){if(h||!t.apply(this,arguments))return;var x=c.currentTarget,G=_(this,D,!0).event(c),z=P(c.view).on("mousemove.zoom",b,!0).on("mouseup.zoom",A,!0),U=vt(c,x),E=c.clientX,d=c.clientY;yn(c.view),se(c),G.mouse=[U,this.__zoom.invert(U)],Qt(this),G.start();function b(R){if($t(R),!G.moved){var j=R.clientX-E,O=R.clientY-d;G.moved=j*j+O*O>y}G.event(R).zoom("mouse",n(S(G.that.__zoom,G.mouse[0]=vt(R,x),G.mouse[1]),G.extent,i))}function A(R){z.on("mousemove.zoom mouseup.zoom",null),vn(R.view,G.moved),$t(R),G.event(R).end()}}function W(c,...D){if(t.apply(this,arguments)){var x=this.__zoom,G=vt(c.changedTouches?c.changedTouches[0]:c,this),z=x.invert(G),U=x.k*(c.shiftKey?.5:2),E=n(S(w(x,U),G,z),e.apply(this,D),i);$t(c),f>0?P(this).transition().duration(f).call(B,E,G,c):P(this).call(u.transform,E,G,c)}}function et(c,...D){if(t.apply(this,arguments)){var x=c.touches,G=x.length,z=_(this,D,c.changedTouches.length===G).event(c),U,E,d,b;for(se(c),E=0;E<G;++E)d=x[E],b=vt(d,this),b=[b,this.__zoom.invert(b),d.identifier],z.touch0?!z.touch1&&z.touch0[2]!==b[2]&&(z.touch1=b,z.taps=0):(z.touch0=b,U=!0,z.taps=1+!!a);a&&(a=clearTimeout(a)),U&&(z.taps<2&&(g=b[0],a=setTimeout(function(){a=null},v)),Qt(this),z.start())}}function q(c,...D){if(this.__zooming){var x=_(this,D).event(c),G=c.changedTouches,z=G.length,U,E,d,b;for($t(c),U=0;U<z;++U)E=G[U],d=vt(E,this),x.touch0&&x.touch0[2]===E.identifier?x.touch0[0]=d:x.touch1&&x.touch1[2]===E.identifier&&(x.touch1[0]=d);if(E=x.that.__zoom,x.touch1){var A=x.touch0[0],R=x.touch0[1],j=x.touch1[0],O=x.touch1[1],nt=(nt=j[0]-A[0])*nt+(nt=j[1]-A[1])*nt,lt=(lt=O[0]-R[0])*lt+(lt=O[1]-R[1])*lt;E=w(E,Math.sqrt(nt/lt)),d=[(A[0]+j[0])/2,(A[1]+j[1])/2],b=[(R[0]+O[0])/2,(R[1]+O[1])/2]}else if(x.touch0)d=x.touch0[0],b=x.touch0[1];else return;x.zoom("touch",n(S(E,d,b),x.extent,i))}}function J(c,...D){if(this.__zooming){var x=_(this,D).event(c),G=c.changedTouches,z=G.length,U,E;for(se(c),h&&clearTimeout(h),h=setTimeout(function(){h=null},v),U=0;U<z;++U)E=G[U],x.touch0&&x.touch0[2]===E.identifier?delete x.touch0:x.touch1&&x.touch1[2]===E.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(E=vt(E,this),Math.hypot(g[0]-E[0],g[1]-E[1])<L)){var d=P(this).on("dblclick.zoom");d&&d.apply(this,arguments)}}}return u.wheelDelta=function(c){return arguments.length?(o=typeof c=="function"?c:Pt(+c),u):o},u.filter=function(c){return arguments.length?(t=typeof c=="function"?c:Pt(!!c),u):t},u.touchable=function(c){return arguments.length?(r=typeof c=="function"?c:Pt(!!c),u):r},u.extent=function(c){return arguments.length?(e=typeof c=="function"?c:Pt([[+c[0][0],+c[0][1]],[+c[1][0],+c[1][1]]]),u):e},u.scaleExtent=function(c){return arguments.length?(s[0]=+c[0],s[1]=+c[1],u):[s[0],s[1]]},u.translateExtent=function(c){return arguments.length?(i[0][0]=+c[0][0],i[1][0]=+c[1][0],i[0][1]=+c[0][1],i[1][1]=+c[1][1],u):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},u.constrain=function(c){return arguments.length?(n=c,u):n},u.duration=function(c){return arguments.length?(f=+c,u):f},u.interpolate=function(c){return arguments.length?(l=c,u):l},u.on=function(){var c=m.on.apply(m,arguments);return c===m?u:c},u.clickDistance=function(c){return arguments.length?(y=(c=+c)*c,u):Math.sqrt(y)},u.tapDistance=function(c){return arguments.length?(L=+c,u):L},u}const V={constants:{windowSize:10,colors:{fullGC:"#ff0000",concurrentGC:"#da546f",mixedGC:"#6666ff",longPause:"#ff7700",mixedLongPause:"#a74800",shortPause:"#018036",normalGC:"#3498db",heapTotal:"#aaaaaa",heapUsed:"#d9534f",serviceLog:"#9b59b6"},radii:{fullGC:5,concurrentGC:3,mixedGC:3,longPause:3,normalGC:2},priority:{fullGC:4,concurrentGC:3,longPause:2,mixedGC:1,normalGC:0},thresholds:{longPauseMs:100},popup:{background:"#ffffff",border:"2px solid #444",borderRadius:"8px",padding:"15px",maxWidth:"80vw",maxHeight:"80vh",boxShadow:"0 4px 20px rgba(0,0,0,0.5)",zIndex:"1000",textColor:"#000000",codeBackground:"#f8f9fa",codeColor:"#2c3e50",codeBorder:"1px solid #ddd"}},accessLog:{windowSize:30,showStatusBar:!1,metrics:["rps","Bps"],visuals:{rateHeightRatio:.5,bandHeight:30,dotRadius:2,highlightDotRadius:4,highlightThreshold:.3},colors:{rps:{fill:"#3498db",opacity:.1},Bps:{fill:"#e67e22",opacity:.2},status:{error:"#e74c3c",warning:"#f1c40f",success:"#2ecc71"},rank:{0:"#e74c3c",1:"#f1c40f",2:"#2ecc71",default:"#7f8c8d"}}},serviceLog:{windowSize:30,metrics:["procRate","goodsRate"],visuals:{dotRadius:2,rateHeightRatio:.5},colors:{dot:"#9b59b6",airListSch:"#e74c3c",procRate:{fill:"#9b59b6",opacity:.1},goodsRate:{fill:"#f1c40f",opacity:.2}}},serviceAccessLog:{yOffset:"auto",accessLog:{metrics:["Bps"],showStatusBar:!1},serviceLog:{metrics:["goodsRate"]}}};function Et(t){return t>=1024*1024?(t/(1024*1024)).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(1)+" KB":t+" B"}function ue(t){return t==null?"0":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"k":t.toString()}function xt(t,e="auto"){let n;if(e==="auto"?t>=1e3?(n=t,e="ms"):(n=t/1e3,e="μs"):e==="μs"||e==="us"?n=t/1e3:n=t,n<1)return`${Math.round(t)} μs`;if(n<1e3)return e==="μs"?`${Math.round(t)} μs (${n.toFixed(1)} ms)`:`${Math.round(n)} ms`;const o=Math.floor(n/1e3),r=Math.floor(o/60),s=o%60;return r>0?`${Math.round(n)} ms (${r}m ${s}s)`:`${Math.round(n)} ms (${s}s)`}function Ft(t,e){const n=document.getElementById("timezone-select"),o=n?n.value:"local";if(o==="local"){const a=w=>w.toString().padStart(2,"0"),g=t.getFullYear(),h=a(t.getMonth()+1),v=a(t.getDate()),p=a(t.getHours()),y=a(t.getMinutes()),L=a(t.getSeconds()),u=t.getMilliseconds().toString().padStart(3,"0");return`${g}-${h}-${v} ${p}:${y}:${L}.${u}`}const r=parseInt(o.substring(1,3)),s=parseInt(o.substring(3,5)),i=r*60+s,f=o[0]==="+"?1:-1;return new Date(t.getTime()+f*i*60*1e3).toISOString().replace("T"," ").substring(0,23)+" "+o}const st={name:"AccessLog",_events:[],_regex:/\[(\d{2}\/[A-Za-z]{3}\/\d{4}:\d{2}:\d{2}:\d{2}\s[+-]\d{4})\]\s+"([A-Z]+)\s+([^"]+)\s+HTTP[^"]*"(?:\s+(\d+))?(?:\s+(\d+))?(?:\s+(\d+))?/,reset(){this._events=[],console.log("[AccessLog] Reset.")},parse(t){const e=t.match(this._regex);if(e){const n=e[1],o=n.replace(":"," ").replace(/\//g," "),r=new Date(o);if(!isNaN(r.getTime()))return this._events.push({timestamp:r,timestampRaw:n,method:e[2],url:e[3],status:e[4]?parseInt(e[4],10):null,size:e[5]?parseInt(e[5],10):0,latency:e[6]?parseInt(e[6],10):0,originalLine:t}),!0}return!1},finish(){if(this._events.sort((l,m)=>l.timestamp-m.timestamp),this._events.length===0)return;const t=new Map;this._events.forEach(l=>{const m=`${l.method} ${l.url}`;t.set(m,(t.get(m)||0)+1)});const n=Array.from(t.entries()).sort((l,m)=>m[1]-l[1]).slice(0,3).map(l=>l[0]),o=["#e74c3c","#b28e00ff","#01aa48ff"],r="#95a5a6";this._events.forEach(l=>{const m=`${l.method} ${l.url}`,a=n.indexOf(m);l.color=a!==-1?o[a]:r,l.rank=a}),this._top3Legend=n.map((l,m)=>({label:l,color:o[m],count:t.get(l)}));const s=new Map;this._events.forEach(l=>{const m=l.timestamp.getTime();s.has(m)||s.set(m,[]),s.get(m).push(l)}),s.forEach((l,m)=>{const g=1e3/(l.length+1);l.forEach((h,v)=>{h.timestamp=new Date(m+(v+1)*g)})}),this._events.sort((l,m)=>l.timestamp-m.timestamp);const f=(V?V.accessLog:{windowSize:30}).windowSize||30;this._events.forEach((l,m)=>{const a=Math.max(0,m-f),g=this._events[a],h=Math.max(l.timestamp-g.timestamp,l.latency/1e3)/1e3;if(h>0){const v=m-a;l.rps=v/h;let p=0;for(let y=a+1;y<=m;y++)p+=this._events[y].size||0;l.Bps=p/h}else l.rps=0,l.Bps=0})},render(t,e,n){if(console.log(`[AccessLog] render() called. Events to draw: ${this._events.length}`),this._events.length===0)return;const{x:o}=e,{height:r}=n,s=window.GCGraphConfig?window.GCGraphConfig.accessLog:{metrics:["rps"],colors:{}},i=s.metrics||["rps"],f=s.visuals||{bandHeight:30,dotRadius:2},l=f.bandHeight||30,m=f.dotRadius||2,a=m;t.select(".ext-access-log").remove();const g=t.append("g").attr("class","ext-access-log").attr("transform","translate(0,0)");this._cachedBars=null,this._cachedDots=null,this._cachedRatePaths=new Map;const h=r*(f.rateHeightRatio||.5);this._yScales={},i.forEach(u=>{if(u==="rps"||u==="Bps"){const w=At(this._events,S=>S[u]);if(w>0){const S=Wt().domain([0,w]).range([a,a+h]);this._yScales[u]=S;const M=pt().x(H=>o(H.timestamp)).y0(0).y1(H=>S(H[u])).curve(dt),B=s.colors&&s.colors[u]||{},_=B.fill||(u==="rps"?"steelblue":"orange"),$=B.opacity||.1,F=g.append("path").datum(this._events).attr("class",`acc-rate-area acc-rate-${u}`).attr("d",M).attr("fill",_).attr("opacity",$).attr("stroke","none");this._cachedRatePaths.set(u,F)}}}),s.showStatusBar!==!1&&(g.selectAll(".acc-bar").data(this._events).enter().append("line").attr("class","acc-bar").attr("x1",u=>o(u.timestamp)).attr("x2",u=>o(u.timestamp)).attr("y1",a).attr("y2",a+l).attr("stroke",u=>{const w=u.status||200,S=s.colors.status||{};return w>=500?S.error||"#e74c3c":w>=400?S.warning||"#f1c40f":S.success||"#2ecc71"}).attr("stroke-width",1).attr("stroke-opacity",.6),this._cachedBars=g.selectAll(".acc-bar"));const v=this._getTop3Requests(),p=s.colors.rank||{},y=At(this._events,u=>u.size)||0,L=f.highlightThreshold||.3;this._events.forEach(u=>{const w=Et(u.size),S=Et(u.Bps)+"/s",M=xt(u.latency,"μs");u._tooltipHtml=`<strong>Access: ${u.method} ${u.url}</strong><br/>Time: ${Ft(u.timestamp,u.timestampRaw)}<br/>Status: ${u.status} | Size: ${w}<br/>Latency: ${M}<br/>Rates: ${u.rps.toFixed(1)} RPS | ${S}`}),g.selectAll(".acc-dot").data(this._events).enter().append("circle").attr("class","acc-dot").attr("cx",u=>o(u.timestamp)).attr("cy",u=>{const w=y*L;return(u.size>w&&w>0?f.highlightDotRadius||4:m)*2.5}).attr("r",u=>{const w=y*L,S=u.size>w&&w>0?f.highlightDotRadius||4:m;return u._baseRadius=S,S}).attr("fill",u=>{const w=`${u.method} ${u.url}`,S=v.indexOf(w);return S!==-1?p[S]||p.default||"#7f8c8d":p.default||"#7f8c8d"}).style("opacity",u=>{const w=`${u.method} ${u.url}`;return v.indexOf(w)!==-1?1:.1}).on("mouseover",function(u,w){P(this).attr("r",w._baseRadius+2),P("#tooltip").style("opacity",1).html(w._tooltipHtml).style("left",u.pageX+10+"px").style("top",u.pageY-10+"px")}).on("mouseout",function(u,w){P(this).attr("r",w._baseRadius),P("#tooltip").style("opacity",0)}).on("click",function(u,w){const S=P("#gc-popup"),M=P("#gc-overlay"),B=V.constants,_=Et(w.size),$=Et(w.Bps)+"/s",F=xt(w.latency,"μs"),H=`
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <strong style="font-size: 16px; color: ${w.color};">Access: ${w.method} ${w.url}</strong>
              <button id="close-popup" style="background: #444; border: none; color: #fff; padding: 5px 10px; cursor: pointer; border-radius: 4px;">✕</button>
            </div>
            <div style="margin-bottom: 10px; color: ${B.popup.textColor};">
              <strong>Time:</strong> ${Ft(w.timestamp,w.timestampRaw)}<br/>
              <strong>Status:</strong> ${w.status} | <strong>Size:</strong> ${_}<br/>
              <strong>Latency:</strong> ${F}<br/>
              <strong>Rates:</strong> ${w.rps.toFixed(1)} RPS | ${$}
            </div>
            <div style="background: ${B.popup.codeBackground}; color: ${B.popup.codeColor}; padding: 10px; border-radius: 4px; font-family: monospace; white-space: pre-wrap; font-size: 12px; border: ${B.popup.codeBorder};">
${w.originalLine}
            </div>
          `;S.html(H).style("display","block"),M.style("display","block");const W=document.getElementById("close-popup");W&&(W.onclick=null,W.onclick=()=>{S.style("display","none"),M.style("display","none")})})},_getTop3Requests(){const t={};return this._events.forEach(e=>{const n=`${e.method} ${e.url}`;t[n]=(t[n]||0)+1}),Object.entries(t).sort((e,n)=>n[1]-e[1]).slice(0,3).map(e=>e[0])},onZoom(t){const{x:e}=t;if(!this._cachedDots||this._cachedDots.empty()){const r=P(".ext-access-log");if(r.empty())return;this._cachedBars=r.selectAll(".acc-bar"),this._cachedDots=r.selectAll(".acc-dot")}const o=(V?V.accessLog:{metrics:["rps"]}).metrics||["rps"];this._cachedBars&&!this._cachedBars.empty()&&this._cachedBars.attr("x1",r=>e(r.timestamp)).attr("x2",r=>e(r.timestamp)),this._cachedDots&&!this._cachedDots.empty()&&this._cachedDots.attr("cx",r=>e(r.timestamp)),o.forEach(r=>{if(this._yScales&&this._yScales[r]){const s=this._yScales[r],i=pt().x(l=>e(l.timestamp)).y0(0).y1(l=>s(l[r])).curve(dt),f=this._cachedRatePaths.get(r);f?f.attr("d",i):P(`.acc-rate-${r}`).attr("d",i)}})}},je=/(\d{4}-\d{2}-\d{2})\s(\d{2}:\d{2}:\d{2})\s\[([^\]]+)\]/,Qo=new RegExp(`${je.source}(.*)`),Ko=/\[([a-zA-Z0-9_]+)#([a-zA-Z0-9_]+\(\))\]\s+:\s+START/,Jo=/\[([a-zA-Z0-9_]+)#([a-zA-Z0-9_]+\(\))\]\s+:\s+END.*?Processing\s+time\s+\[([^\]]+)\]\s+ms(?:\s+lastGoodsCount\s+:\s+(\d+))?/,tr=/Total time for getHknAgtInfo: \(ms\) (\d+)/,at={name:"ServiceLog",_events:[],_activeCalls:new Map,reset(){this._events=[],this._activeCalls=new Map,console.log("[ServiceLog] Reset.")},parse(t){const e=t.match(Qo);if(!e)return!1;const n=e[1],o=e[2],r=e[3],s=`${n} ${o}`,i=e[4],f=V?.detectedLogTimezone||"",l=new Date(n+"T"+o+f);if(isNaN(l.getTime()))return!1;const m=i.match(Ko);if(m){const v=m[1],p=m[2];if(p.includes("Sv")){if(!this._activeCalls.has(r))this._activeCalls.set(r,{className:v,methodName:p,startTime:l,startTimeRaw:s,threadId:r,logs:[t],hknAgtTimes:[]});else{const y=this._activeCalls.get(r);y.className=v,y.methodName=p,y.startTime=l,y.startTimeRaw=s,y.logs.push(t)}return!0}}const a=i.match(Jo);if(a){const v=a[1],p=a[2];if(p.includes("Sv")){const y=a[3];let L=0,u=null;if(y.includes(",")){const S=y.split(",").map(M=>M.trim());L=parseInt(S[S.length-1],10),p.includes("airListSchSv")&&(u={gds:{IN:"Infini",AP:"Galileo (Apollo)",AM:"Amadeus"}[S[0]]||S[0],carrierConnectExecuteTime:Math.max(parseInt(S[2],10)||0,parseInt(S[4],10)||0),hknAgtTime:parseInt(S[5],10)||0})}else L=parseInt(y,10);if(!this._activeCalls.has(r))this._activeCalls.set(r,{className:v,methodName:p,startTime:null,startTimeRaw:null,threadId:r,logs:[t],hknAgtTimes:[]});else{const S=this._activeCalls.get(r);S.className||(S.className=v),S.methodName||(S.methodName=p),S.logs.push(t)}const w=this._activeCalls.get(r);return this._events.push({timestamp:w.startTime||l,timestampRaw:w.startTimeRaw,endTime:l,endTimeRaw:s,className:w.className,methodName:w.methodName,threadId:w.threadId,processingTime:L,lastGoodsCount:a[4]?parseInt(a[4],10):null,hknAgtTimes:w.hknAgtTimes,metrics:u,logs:w.logs}),this._activeCalls.delete(r),!0}}if(!this._activeCalls.has(r))return this._activeCalls.set(r,{className:null,methodName:null,startTime:null,startTimeRaw:null,threadId:r,logs:[t],hknAgtTimes:[]}),!0;const g=this._activeCalls.get(r),h=i.match(tr);return h?g.hknAgtTimes.push(parseInt(h[1],10)):g.logs.push(t),!0},finish(){const t=V?.detectedLogTimezone||"";this._events.forEach(r=>{const s=r.timestampRaw||r.endTimeRaw;if(s){const i=s.replace(" ","T")+t,f=new Date(i);isNaN(f.getTime())||(r.timestampRaw?r.timestamp=f:(r.timestamp=f,r.endTime=f))}}),this._events.sort((r,s)=>r.timestamp-s.timestamp);const e=new Map;this._events.forEach(r=>{const s=Math.floor(r.timestamp.getTime()/1e3)*1e3;e.has(s)||e.set(s,[]),e.get(s).push(r)}),e.forEach((r,s)=>{if(r.length>1){const i=1e3/(r.length+1);r.forEach((f,l)=>{f.timestamp=new Date(s+(l+1)*i)})}}),this._events.sort((r,s)=>r.timestamp-s.timestamp);const o=(V?.serviceLog||{windowSize:30}).windowSize||30;this._events.forEach((r,s)=>{const i=Math.max(0,s-o),f=this._events[i],l=Math.max(r.timestamp-f.timestamp,r.processingTime)/1e3;if(l>0){let m=0,a=0;for(let g=i+1;g<=s;g++)m+=this._events[g].processingTime||0,a+=this._events[g].lastGoodsCount||0;r.procRate=m/l,r.goodsRate=a/l}else r.procRate=0,r.goodsRate=0}),window.ServiceLogEvents=this._events,console.log(`[ServiceLog] Finish parsing. Found ${this._events.length} records.`,window.ServiceLogEvents),this._activeCalls.clear()},_getDotRadius(t){const e=t.processingTime||0,n=t.lastGoodsCount||0;return e>=3e4||n>=1e3?5:e>=1e4?4:e>=1e3?3:2},render(t,e,n){if(console.log(`[ServiceLog] Render called. Events: ${this._events.length}`),this._events.length===0)return;const{x:o}=e,r=V?.serviceLog||{},s=r.colors?.airListSch||"#e74c3c",i=r.colors?.dot||"#9b59b6",f=r.metrics||["procRate","goodsRate"],l=r.visuals||{dotRadius:2,rateHeightRatio:.5},a=l.dotRadius||2,g=n.height*(l.rateHeightRatio||.5);t.select(".ext-service-log").remove();const h=t.append("g").attr("class","ext-service-log");this._cachedDots=null,this._cachedRatePaths=new Map,this._yScales={};const v=this;f.forEach(p=>{const y=At(this._events,L=>L[p]);if(y>0){const L=Wt().domain([0,y]).range([a,a+g]);this._yScales[p]=L;const u=pt().x(_=>o(_.timestamp)).y0(0).y1(_=>L(_[p])).curve(dt),w=r.colors&&r.colors[p]||{},S=w.fill||(p==="procRate"?"#9b59b6":"#f1c40f"),M=w.opacity||.1,B=h.append("path").datum(this._events).attr("class",`svc-rate-area svc-rate-${p}`).attr("d",u).attr("fill",S).attr("opacity",M).attr("stroke","none");this._cachedRatePaths.set(p,B)}}),this._events.forEach(p=>{const y=p.timestampRaw?"Start Time":"End Time",L=Ft(p.timestampRaw?p.timestamp:p.endTime,p.timestampRaw||p.endTimeRaw),u=xt(p.processingTime,"ms");let w="";if(p.lastGoodsCount!==null){const _=ue(p.lastGoodsCount);w=`<br/>Goods: ${p.lastGoodsCount.toString()!==_?`${p.lastGoodsCount} (${_})`:p.lastGoodsCount}`}const S=p.procRate>0?`${p.procRate.toFixed(1)} ms/s`:"0",M=p.goodsRate>0?`${p.goodsRate.toFixed(1)} goods/s`:"0",B=`<br/>Rates: ${S} | ${M}`;p._tooltipHtml=`<strong>Service: ${p.methodName}</strong><br/>${y}: ${L}<br/>Processing Time: ${u}${w}${B}`}),this._cachedDots=null,h.selectAll(".svc-dot").data(this._events).enter().append("circle").attr("class","svc-dot").attr("cx",p=>o(p.timestamp)).attr("cy",p=>v._getDotRadius(p)*2.5).attr("r",p=>v._getDotRadius(p)).attr("fill",p=>p.methodName.includes("airListSchSv")?s:i).style("cursor","pointer").on("mouseover",function(p,y){const L=v._getDotRadius(y);P(this).attr("r",L+2),P("#tooltip").style("opacity",1).html(y._tooltipHtml).style("left",p.pageX+10+"px").style("top",p.pageY-10+"px")}).on("mouseout",function(p,y){P(this).attr("r",v._getDotRadius(y)),P("#tooltip").style("opacity",0)}).on("click",function(p,y){const L=P("#gc-popup"),u=P("#gc-overlay"),w=V.constants,S=y.methodName.includes("airListSchSv")?s:i,M=y.procRate>0?`${y.procRate.toFixed(1)} ms/s`:"0",B=y.goodsRate>0?`${y.goodsRate.toFixed(1)} goods/s`:"0";let _="";if(y.hknAgtTimes&&y.hknAgtTimes.length>0){const H=`[${y.hknAgtTimes.join(", ")}]`;y.hknAgtTimes.length>100?_=`<br/><details><summary><strong>HknAgtTimes:</strong> ${y.hknAgtTimes.length} items</summary>
                <div style="font-size: 11px; margin-top: 5px; word-break: break-all;">${H}</div>
              </details>`:_=`<br/><strong>HknAgtTimes:</strong> ${H}`}const $=`
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
              <strong style="font-size: 16px; color: ${S};">Service: ${y.methodName}</strong>
              <button id="close-popup" style="background: #444; border: none; color: #fff; padding: 5px 10px; cursor: pointer; border-radius: 4px;">✕</button>
            </div>
            <div style="margin-bottom: 10px; color: ${w.popup.textColor};">
              <strong>Class:</strong> ${y.className}<br/>
              <strong>Thread:</strong> ${y.threadId}<br/>
              <strong>${y.timestampRaw?"Start Time":"End Time"}:</strong> ${Ft(y.timestampRaw?y.timestamp:y.endTime,y.timestampRaw||y.endTimeRaw)}<br/>
              <strong>Processing Time:</strong> ${xt(y.processingTime,"ms")}
              ${y.lastGoodsCount!==null?(()=>{const H=ue(y.lastGoodsCount);return`<br/><strong>Last Goods Count:</strong> ${y.lastGoodsCount.toString()!==H?`${y.lastGoodsCount} (${H})`:y.lastGoodsCount}`})():""}
              <br/><strong>Rates:</strong> ${M} | ${B}
              ${y.metrics?`
                <br/><strong>GDS:</strong> ${y.metrics.gds}
                <br/><strong>CarrierConnectExecuteTime:</strong> ${xt(y.metrics.carrierConnectExecuteTime,"ms")}
                <br/><strong>HknAgtTime:</strong> ${xt(y.metrics.hknAgtTime,"ms")}
              `:""}
              ${_}
            </div>
            <div style="background: ${w.popup.codeBackground}; color: ${w.popup.codeColor}; padding: 10px; border-radius: 4px; font-family: monospace; white-space: pre-wrap; font-size: 12px; border: ${w.popup.codeBorder}; max-height: 50vh; overflow-y: auto;"
            >${y.logs.map(H=>{const W=H.match(je);return W?`(${W[2]}) ${H.substring(W.index+W[0].length)}`:H}).join(`
`)}</div>
          `;L.html($).style("display","block"),u.style("display","block");const F=document.getElementById("close-popup");F&&(F.onclick=null,F.onclick=()=>{L.style("display","none"),u.style("display","none")})}),this._cachedDots=h.selectAll(".svc-dot")},onZoom(t){const{x:e}=t;if(!this._cachedDots||this._cachedDots.empty()){const r=P(".ext-service-log");if(r.empty())return;this._cachedDots=r.selectAll(".svc-dot")}this._cachedDots.attr("cx",r=>e(r.timestamp)),((V?.serviceLog||{}).metrics||["procRate","goodsRate"]).forEach(r=>{if(this._yScales&&this._yScales[r]){const s=this._yScales[r],i=pt().x(l=>e(l.timestamp)).y0(0).y1(l=>s(l[r])).curve(dt),f=this._cachedRatePaths?this._cachedRatePaths.get(r):null;f?f.attr("d",i):P(`.svc-rate-${r}`).attr("d",i)}})}},er={name:"ServiceAccessLog",_accessLog:null,_serviceLog:null,reset(){this._accessLog=Object.create(st),this._accessLog._events=[],st.reset&&st.reset.call(this._accessLog),this._serviceLog=Object.create(at),this._serviceLog._events=[],this._serviceLog._activeCalls=new Map,at.reset&&at.reset.call(this._serviceLog),console.log("[ServiceAccessLog] Reset.")},parse(t){let e=!1;return this._accessLog&&st.parse&&(e=st.parse.call(this._accessLog,t)||e),this._serviceLog&&at.parse&&(e=at.parse.call(this._serviceLog,t)||e),e},finish(){this._accessLog&&st.finish&&st.finish.call(this._accessLog),this._serviceLog&&at.finish&&at.finish.call(this._serviceLog),console.log(`[ServiceAccessLog] Finish. AccessLog: ${this._accessLog?._events?.length||0}, ServiceLog: ${this._serviceLog?._events?.length||0}`)},render(t,e,n){if(console.log("[ServiceAccessLog] Render called."),!st||!at){console.error("[ServiceAccessLog] Component extensions not found!");return}const o=V?.serviceAccessLog||{},s=(o.accessLog?.visuals||V?.accessLog?.visuals||{}).highlightDotRadius||4,i=o.yOffset==="auto"?s*2.5+2:o.yOffset||12,f={...V.accessLog,...o.accessLog,metrics:o.accessLog?.metrics||["Bps"],showStatusBar:o.accessLog?.showStatusBar!==void 0?o.accessLog.showStatusBar:!1},l={...V.serviceLog,...o.serviceLog,metrics:o.serviceLog?.metrics||["goodsRate"]},m=V.accessLog,a=V.serviceLog;if(V.accessLog=f,V.serviceLog=l,this._accessLog&&st.render&&st.render.call(this._accessLog,t,e,n),this._serviceLog&&at.render){const g=t.append("g").attr("class","ext-service-log-offset").attr("transform",`translate(0, ${i})`);at.render.call(this._serviceLog,g,e,n)}V.accessLog=m,V.serviceLog=a},onZoom(t){this._accessLog&&st.onZoom&&st.onZoom.call(this._accessLog,t),this._serviceLog&&at.onZoom&&at.onZoom.call(this._serviceLog,t)}};window.GCGraphConfig=V;window.formatResponseSize=Et;window.formatCountHuman=ue;window.formatDurationHuman=xt;window.formatTimestampInTz=Ft;window.GCGraphExtensions||(window.GCGraphExtensions=[]);window.GCGraphExtensions.push(st);window.GCGraphExtensions.push(at);window.GCGraphExtensions.push(er);const C=V.constants;C.graph={areaTotal:{fill:C.colors.heapTotal+"20",stroke:C.colors.heapTotal,strokeWidth:1},areaUsed:{fill:C.colors.heapUsed+"20",stroke:C.colors.heapUsed,strokeWidth:1},lineTotal:{stroke:C.colors.heapTotal,strokeWidth:1.5},lineUsed:{stroke:C.colors.heapUsed,strokeWidth:1.5}};C.rates={allocRate:{stroke:C.colors.longPause,strokeWidth:2,strokeDasharray:""},gcRate:{stroke:C.colors.shortPause,strokeWidth:2,strokeDasharray:""},meanAllocRate:{stroke:C.colors.longPause,strokeWidth:1.5,strokeDasharray:"5,5"},meanGcRate:{stroke:C.colors.shortPause,strokeWidth:1.5,strokeDasharray:"5,5"}};let K=null,Bt=null;document.getElementById("log-input").addEventListener("change",or);document.getElementById("graph-type").addEventListener("change",()=>{K&&Rt(K)});document.getElementById("show-segments").addEventListener("change",()=>{K&&Rt(K)});document.getElementById("show-rates").addEventListener("change",()=>{K&&Rt(K)});document.getElementById("timezone-select").addEventListener("change",()=>{K&&Rt(K)});const Nt=document.getElementById("extension-select");Nt.addEventListener("change",()=>{K&&Rt(K)});(function(){window.GCGraphExtensions&&window.GCGraphExtensions.length>0&&(window.GCGraphExtensions.forEach(t=>{const e=document.createElement("option");e.value=t.name,e.textContent=t.name,Nt.appendChild(e)}),Nt.options.length>1&&(Nt.selectedIndex=1)),nr()})();document.getElementById("reset-zoom").addEventListener("click",()=>{window.resetZoom&&window.resetZoom()});const It=document.getElementById("status"),zt=document.getElementById("chart-container");async function nr(){const t=await fetch("test.log");if(!t.ok){console.log("No default log found. Waiting for file upload...");return}const e=await t.text();Xe("test.log (default)",e)}async function or(t){const e=t.target.files[0];if(!e)return;It.textContent="Reading file...",Bt=null;const n=new FileReader;n.onload=async function(o){const r=o.target.result;It.textContent="Parsing...",Xe(e.name,r)},n.readAsText(e)}async function Xe(t="(default)",e=null){try{K&&(K=null),await new Promise(s=>setTimeout(s,10)),K=await rr(e);const n=document.getElementById("timezone-select"),o=K.detectedTimezone;n.innerHTML="";const r=document.createElement("option");if(r.value="local",r.textContent="Local",n.appendChild(r),o){const s=document.createElement("option");s.value=o,s.textContent=`Log (UTC${o})`,s.selected=!0,n.appendChild(s)}It.textContent=`${t}: ${K.length} GC events parsed${K.truncated?" (truncated)":""}`,Bt=null,Rt(K)}catch(n){console.error(n),It.textContent="Error parsing file: "+n.message}}async function rr(t){const e=t.split(/\r?\n/),n=new Map;let o=0,r=0;const s=1e4,i=1e3;for(window.GCGraphExtensions.forEach(a=>{typeof a.reset=="function"&&a.reset()});r<e.length&&o<s;){const a=s-o,g=Math.min(i,a),h=sr(e,r,g,n);r=h.nextLine,o+=h.eventsParsedCount,It.textContent=`Parsing... ${o} events found`,await new Promise(v=>setTimeout(v,0))}let f=o>=s;const l=Array.from(n.values()).filter(a=>a.parsed&&a.timestamp).map(a=>(a.action=a.actions.join(" + "),a.duration=Math.round(a.totalDuration*100)/100,a)).sort((a,g)=>a.timestamp-g.timestamp);let m=null;if(l.length>0&&l[0].timestampRaw){const a=l[0].timestampRaw.match(/([+-]\d{4})$/);a&&(m=a[1])}if(window.GCGraphConfig&&(window.GCGraphConfig.detectedLogTimezone=m),l.forEach(a=>{const g=a.actions.some(h=>h.includes("Concurrent")||h.includes("Remark")||h.includes("Cleanup"));a.action.includes("Pause Full")?(a.color=C.colors.fullGC,a.priority=C.priority.fullGC,a.radius=C.radii.fullGC):g?(a.color=C.colors.concurrentGC,a.priority=C.priority.concurrentGC,a.radius=C.radii.concurrentGC):a.duration>C.thresholds.longPauseMs?(a.color=C.colors.longPause,a.priority=C.priority.longPause,a.radius=C.radii.longPause,a.action.includes("Mixed")&&(a.color=C.colors.mixedLongPause)):a.action.includes("Mixed")?(a.color=C.colors.mixedGC,a.priority=C.priority.mixedGC,a.radius=C.radii.mixedGC):(a.color=C.colors.normalGC,a.priority=C.priority.normalGC,a.radius=C.radii.normalGC)}),l.length>1){const a=l[0].timestamp.getTime(),h=l[l.length-1].timestamp.getTime()-a,v=h/l.length,p=(1<<30)/1e3;let y=l[0].beforeBytes,L=0,u=0;l.forEach((M,B)=>{M.allocatedBytes=Math.max(0,M.beforeBytes-y),M.reclaimedBytes=Math.max(0,M.beforeBytes-M.afterBytes),L+=M.allocatedBytes,u+=M.reclaimedBytes,y=M.afterBytes,M.elapsedMs=M.timestamp.getTime()-a;let _=M.allocatedBytes,$=M.reclaimedBytes,F=M.elapsedMs;for(let W=B-1;W>Math.max(-1,B-C.windowSize);W--)_+=l[W].allocatedBytes,$+=l[W].reclaimedBytes,F=l[W].elapsedMs;let H=B<C.windowSize?h:M.elapsedMs-F;H=Math.max(H,M.totalDuration),M.instantAllocRate=_/H/p,M.instantGcRate=$/H/p});const w=h>0?L/h/p:0,S=h>0?u/h/p:0;l.rateStats={meanAllocRate:w,meanGcRate:S,meanIntervalMs:v,totalAllocated:L,totalReclaimed:u,totalTimeMs:h}}return l.detectedTimezone=m,l.truncated=f,window.GCGraphExtensions.forEach(a=>{typeof a.finish=="function"&&a.finish()}),l}function sr(t,e,n,o){const r=/GC\((\d+)\)/,s=/\[(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+\+\d{4})\]/,i=/(\d+(?:\.\d+)?)([KMG]B?)->(\d+(?:\.\d+)?)([KMG]B?)\((\d+(?:\.\d+)?)([KMG]B?)\)/,f=/(\d+(?:\.\d+)?)ms/;let l=0,m=e;for(;m<t.length&&l<n;m++){const a=t[m],g=a.match(r);if(window.GCGraphExtensions.forEach(p=>{typeof p.parse=="function"&&p.parse(a)}),!g)continue;const h=parseInt(g[1],10);o.has(h)||o.set(h,{id:h,rawLines:[],parsed:!1,timestamp:null,actions:[],beforeBytes:0,afterBytes:0,totalBytes:0,totalDuration:0});const v=o.get(h);if(v.rawLines.push(a),!v.parsed){const p=a.match(s);if(p&&!v.timestamp&&(v.timestampRaw=p[1],v.timestamp=new Date(p[1]),window.GCGraphConfig&&!window.GCGraphConfig.detectedLogTimezone)){const L=p[1].match(/([+-]\d{4})$/);L&&(window.GCGraphConfig.detectedLogTimezone=L[1],console.log(`[app.js] Early timezone detection: ${L[1]}`))}const y=a.match(i);if(y){v.beforeBytes=ae(y[1],y[2]),v.afterBytes=ae(y[3],y[4]),v.totalBytes=ae(y[5],y[6]);const L=a.substring(a.indexOf("GC(")+3+h.toString().length+1,y.index).trim();L&&!v.actions.includes(L)&&v.actions.push(L);const u=a.match(f);u&&(v.totalDuration+=parseFloat(u[1])),v.parsed=!0,l++}}}return{eventsParsedCount:l,nextLine:m}}function ae(t,e){const n=parseFloat(t);switch(e.replace("B","")){case"G":return n*(1<<30);case"M":return n*(1<<20);case"K":return n*1024;default:return n}}function Rt(t){if(P(zt).selectAll("svg").interrupt().on(".zoom",null),zt.innerHTML="",t.length===0){zt.innerHTML="<p>No valid GC data found.</p>";return}const e={top:10,right:60,bottom:20,left:50},n=zt.clientWidth-e.left-e.right,o=400-e.top-e.bottom,r=P(zt).append("svg").attr("width",n+e.left+e.right).attr("height",o+e.top+e.bottom),s=`chart-clip-${Date.now()}`;r.append("defs").append("clipPath").attr("id",s).append("rect").attr("width",n).attr("height",o);const i=r.append("g").attr("transform",`translate(${e.left},${e.top})`),f=No().domain(cn(t,d=>d.timestamp)).range([0,n]),l=f.copy(),m=1<<30,a=d=>d/m,g=At(t,d=>Math.max(a(d.totalBytes),a(d.beforeBytes))),h=Wt().domain([0,g*1.02]).nice().range([o,0]),v=d=>d<.1?(d*1024).toFixed(1)+" MB":d.toFixed(1)+" GB",p=ve("%H:%M:%S"),y=Ze("%H:%M:%S"),L=document.getElementById("timezone-select").value,u=L==="local"?null:L,w=d=>{if(!u)return p(d);const b=parseInt(u.substring(1,3)),A=parseInt(u.substring(3,5)),R=b*60+A,j=u[0]==="+"?1:-1,O=new Date(d.getTime()+j*R*60*1e3);return y(O)},S=i.append("g").attr("class","x-axis").attr("transform",`translate(0,${o})`).call(Me(f).tickFormat(w));i.append("g").attr("class","y-axis").call(_e(h).tickFormat(v)),i.append("g").attr("class","grid").call(_e(h).tickSize(-n).tickFormat(""));const M=i.append("g").attr("clip-path",`url(#${s})`),B=document.getElementById("graph-type").value;if(B==="area"){const d=pt().x(A=>f(A.timestamp)).y0(o).y1(A=>h(a(A.totalBytes)));M.append("path").datum(t).attr("class","area area-heap-total").attr("d",d).attr("fill",C.graph.areaTotal.fill).attr("stroke",C.graph.areaTotal.stroke).attr("stroke-width",C.graph.areaTotal.strokeWidth);const b=pt().x(A=>f(A.timestamp)).y0(o).y1(A=>h(a(A.afterBytes)));M.append("path").datum(t).attr("class","area area-heap-used").attr("d",b).attr("fill",C.graph.areaUsed.fill).attr("stroke",C.graph.areaUsed.stroke).attr("stroke-width",C.graph.areaUsed.strokeWidth)}else{const d=ut().x(A=>f(A.timestamp)).y(A=>h(a(A.totalBytes)));M.append("path").datum(t).attr("class","line line-heap-total").attr("d",d).attr("fill","none").attr("stroke",C.graph.lineTotal.stroke).attr("stroke-width",C.graph.lineTotal.strokeWidth);const b=ut().x(A=>f(A.timestamp)).y(A=>h(a(A.afterBytes)));M.append("path").datum(t).attr("class","line line-heap-used").attr("d",b).attr("fill","none").attr("stroke",C.graph.lineUsed.stroke).attr("stroke-width",C.graph.lineUsed.strokeWidth)}document.getElementById("show-segments").checked&&M.selectAll(".gc-segment").data(t).enter().append("line").attr("class","gc-segment").attr("x1",d=>f(d.timestamp)).attr("x2",d=>f(d.timestamp)).attr("y1",d=>h(a(d.beforeBytes))).attr("y2",d=>h(a(d.afterBytes))).attr("stroke",d=>d.color).attr("stroke-width",1).attr("stroke-opacity",.6);const $=document.getElementById("show-rates").checked;let F=null;if($&&t.rateStats){const d=t.rateStats,b=At(t,O=>Math.max(O.instantAllocRate||0,O.instantGcRate||0));F=Wt().domain([0,b*1.02]).range([o,0]);const A=O=>O<.1?(O*1024).toFixed(1)+" MB/s":O.toFixed(2)+" GB/s";i.append("g").attr("class","y-axis-right").attr("transform",`translate(${n}, 0)`).call(pn(F).tickFormat(A)).selectAll("text").style("fill","#666"),M.append("line").attr("class","mean-alloc-rate").attr("x1",0).attr("x2",n).attr("y1",F(d.meanAllocRate)).attr("y2",F(d.meanAllocRate)).attr("stroke",C.rates.meanAllocRate.stroke).attr("stroke-width",C.rates.meanAllocRate.strokeWidth).attr("stroke-dasharray",C.rates.meanAllocRate.strokeDasharray),M.append("line").attr("class","mean-gc-rate").attr("x1",0).attr("x2",n).attr("y1",F(d.meanGcRate)).attr("y2",F(d.meanGcRate)).attr("stroke",C.rates.meanGcRate.stroke).attr("stroke-width",C.rates.meanGcRate.strokeWidth).attr("stroke-dasharray",C.rates.meanGcRate.strokeDasharray);const R=ut().x(O=>f(O.timestamp)).y(O=>F(O.instantAllocRate||0)).curve(dt);M.append("path").datum(t).attr("class","line alloc-rate-line").attr("d",R).attr("fill","none").attr("stroke",C.rates.allocRate.stroke).attr("stroke-width",C.rates.allocRate.strokeWidth);const j=ut().x(O=>f(O.timestamp)).y(O=>F(O.instantGcRate||0)).curve(dt);M.append("path").datum(t).attr("class","line gc-rate-line").attr("d",j).attr("fill","none").attr("stroke",C.rates.gcRate.stroke).attr("stroke-width",C.rates.gcRate.strokeWidth)}const H=document.getElementById("extension-select"),W=H?H.value:"none";window.GCGraphExtensions.forEach(d=>{if(W!=="none"&&d.name===W&&typeof d.render=="function")try{d.render(M,{x:f,y:h},{width:n,height:o})}catch(b){console.error(`Error rendering extension ${d.name}:`,b)}});const et=P("#tooltip");let q=P("#gc-popup");q.empty()&&(q=P("body").append("div").attr("id","gc-popup").style("display","none").style("position","fixed").style("top","50%").style("left","50%").style("transform","translate(-50%, -50%)").style("background",C.popup.background).style("border",C.popup.border).style("border-radius",C.popup.borderRadius).style("padding",C.popup.padding).style("max-width",C.popup.maxWidth).style("max-height",C.popup.maxHeight).style("overflow","auto").style("z-index",C.popup.zIndex).style("box-shadow",C.popup.boxShadow));let J=P("#gc-overlay");J.empty()&&(J=P("body").append("div").attr("id","gc-overlay").style("display","none").style("position","fixed").style("top","0").style("left","0").style("width","100%").style("height","100%").style("background","rgba(0,0,0,0.5)").style("z-index","999").on("click",()=>{J.style("display","none"),q.style("display","none")})),M.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("cx",d=>f(d.timestamp)).attr("cy",d=>h(a(d.afterBytes))).attr("r",d=>d.radius).attr("fill",d=>d.color).attr("stroke","#fff").attr("stroke-width",0).style("cursor","pointer").on("mouseover",function(d,b){P(this).attr("r",b.radius+3),et.transition().duration(200).style("opacity",.9);const A=window.formatTimestampInTz(b.timestamp,b.timestampRaw),R=`<strong>GC(${b.id}): ${b.action}</strong><br/>Time: ${A}<br/>Memory: ${_t(b.beforeBytes)} -> ${_t(b.afterBytes)} / ${_t(b.totalBytes)}<br/>Duration: ${window.formatDurationHuman(b.duration,"ms")}`;et.html(R).style("left",d.pageX+15+"px").style("top",d.pageY-28+"px")}).on("mouseout",function(d,b){P(this).attr("r",b.radius),et.transition().duration(500).style("opacity",0)}).on("click",function(d,b){const A=b.rawLines.map(j=>{const O=j.match(/\[gc/);return O?j.substring(O.index):j}),R=`
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <strong style="font-size: 16px; color: ${b.color};">GC(${b.id}) - ${b.action}</strong>
          <button id="close-popup" style="background: #444; border: none; color: #fff; padding: 5px 10px; cursor: pointer; border-radius: 4px;">✕</button>
        </div>
        <div style="margin-bottom: 10px; color: ${C.popup.textColor};">
          Time: ${window.formatTimestampInTz(b.timestamp,b.timestampRaw)}<br/>
          Memory: ${_t(b.beforeBytes)} → ${_t(b.afterBytes)} / ${_t(b.totalBytes)}<br/>
          Duration: <span style="color: ${b.duration>100?C.colors.longPause:C.colors.shortPause};">${window.formatDurationHuman(b.duration,"ms")}</span>
        </div>
        <div style="font-family: monospace; font-size: 11px; white-space: pre-wrap; color: ${C.popup.codeColor}; background: ${C.popup.codeBackground}; border: ${C.popup.codeBorder}; padding: 10px; border-radius: 4px; max-height: 50vh; overflow-y: auto;">${ar(A.join(`
`))}</div>
      `;q.html(R).style("display","block"),J.style("display","block"),P("#close-popup").on("click",()=>{J.style("display","none"),q.style("display","none")})});const c=l.domain()[1]-l.domain()[0],x=Math.max(1,c/(n*1)),G=qo().scaleExtent([1,x]).translateExtent([[0,0],[n,o]]).extent([[0,0],[n,o]]).filter(d=>d.type==="wheel"?!0:d.type==="mousedown"||d.type==="touchstart"?!d.target.classList.contains("dot"):!0).on("zoom",z);r.call(G),Bt&&r.call(G.transform,Bt);function z(d){Bt=d.transform;const b=d.transform.rescaleX(l);f.domain(b.domain()),S.call(Me(f).tickFormat(w)),B==="area"?(M.select(".area-heap-total").attr("d",pt().x(R=>f(R.timestamp)).y0(o).y1(R=>h(a(R.totalBytes)))),M.select(".area-heap-used").attr("d",pt().x(R=>f(R.timestamp)).y0(o).y1(R=>h(a(R.afterBytes))))):(M.select(".line-heap-total").attr("d",ut().x(R=>f(R.timestamp)).y(R=>h(a(R.totalBytes)))),M.select(".line-heap-used").attr("d",ut().x(R=>f(R.timestamp)).y(R=>h(a(R.afterBytes))))),M.selectAll(".dot").attr("cx",R=>f(R.timestamp)),M.selectAll(".gc-segment").attr("x1",R=>f(R.timestamp)).attr("x2",R=>f(R.timestamp)),M.select(".alloc-rate-line").attr("d",ut().x(R=>f(R.timestamp)).y(R=>F?F(R.instantAllocRate||0):0).curve(dt)),M.select(".gc-rate-line").attr("d",ut().x(R=>f(R.timestamp)).y(R=>F?F(R.instantGcRate||0):0).curve(dt));const A=document.getElementById("extension-select").value;window.GCGraphExtensions.forEach(R=>{A!=="none"&&R.name===A&&typeof R.onZoom=="function"&&R.onZoom({x:f,y:h})})}window.resetZoom=function(){r.transition().duration(750).call(G.transform,me)};const U=i.append("g").attr("transform",`translate(${n-180}, 20)`),E=[{color:C.colors.heapTotal,label:"Heap Total",type:"rect"},{color:C.colors.heapUsed,label:"Heap Used (After GC)",type:"rect"},{color:C.colors.fullGC,label:"Full GC",type:"circle",r:C.radii.fullGC},{color:C.colors.concurrentGC,label:"Concurrent GC",type:"circle",r:C.radii.concurrentGC},{color:C.colors.longPause,label:`Long Pause (>${C.thresholds.longPauseMs}ms)`,type:"circle",r:C.radii.longPause},{color:C.colors.mixedGC,label:"Mixed GC",type:"circle",r:C.radii.mixedGC},{color:C.colors.mixedLongPause,label:"Mixed Long Pause",type:"circle",r:C.radii.longPause},{color:C.colors.normalGC,label:"Normal GC",type:"circle",r:C.radii.normalGC}];$&&t.rateStats&&E.push({color:C.rates.allocRate.stroke,label:"Alloc Rate",type:"line"},{color:C.rates.gcRate.stroke,label:"GC Rate",type:"line"}),E.forEach((d,b)=>{d.type==="rect"?U.append("rect").attr("x",0).attr("y",b*18).attr("width",14).attr("height",3).attr("fill",d.color):d.type==="line"?U.append("line").attr("x1",0).attr("x2",14).attr("y1",b*18+5).attr("y2",b*18+5).attr("stroke",d.color).attr("stroke-width",2):U.append("circle").attr("cx",5).attr("cy",b*18+5).attr("r",d.r||4).attr("fill",d.color).attr("stroke","#fff").attr("stroke-width",d.r>1?1:0),U.append("text").attr("x",18).attr("y",b*18+10).text(d.label).style("font-size","11px").attr("alignment-baseline","middle").attr("fill","#444")})}function _t(t){return t>=1<<30?(t/(1<<30)).toFixed(3)+" GB":t>=1<<20?(t/(1<<20)).toFixed(1)+" MB":t+" B"}function ar(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,function(n){return e[n]})}
